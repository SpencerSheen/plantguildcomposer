	<!DOCTYPE html>
	<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
	<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
	<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
	<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title></title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width">
		
		<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/bootstrap-responsive.min.css">
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="css/main.css">
	
		<script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
	</head>
	<body data-spy="scroll" data-target="#navbar" data-offset="20">
		<!--[if lt IE 7]>
			<p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
		<![endif]-->
	
		<!-- This code is taken from http://twitter.github.com/bootstrap/examples/hero.html -->
	
		<div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="#">Plant Guild Composer</a>
					<div class="nav-collapse collapse">
						<ul class="nav">
							<li id="menu-welcome"><a href="#welcome-row" onClick="scroll($(this).attr('href'));">Welcome</a></li>
							<li id="menu-map"  style="display:none;"><a href="#map-row" onClick="scroll($(this).attr('href'));">Map</a></li>
							<li id="menu-options"  style="display:none;"><a href="#options-row" onClick="scroll($(this).attr('href'));">Options</a></li>
							<li id="menu-more"  style="display:none;" class="dropdown">
								<a href="#more-row" class="dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="#">Action</a></li>
									<li><a href="#">Another action</a></li>
									<li><a href="#">Something else here</a></li>
									<li class="divider"></li>
									<li class="nav-header">Nav header</li>
									<li><a href="#">Separated link</a></li>
									<li><a href="#">One more separated link</a></li>
								</ul>
							</li>
						</ul>
						<!--<form class="navbar-form pull-right">
							<input class="span2" type="text" placeholder="Email">
							<input class="span2" type="password" placeholder="Password">
							<button type="submit" class="btn">Sign in</button>
						</form>-->
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
		<!--<header class="jumbotron subhead" id="overview">
			  <div class="inner">
				<div class="container">
				  <h1>Plant Guild Composer</h1>
				  <p class="lead">
					Project by <a href="#" target="_blank">Juliet Norton</a>.
				  </p>
				</div>
			  </div>
		</header>-->
	
		<div class="container">
	
			<!-- Main hero unit for a primary marketing message or call to action -->
			
			<div id="welcome-row"class="row">
				<div id="welcome" class="span12">
					<div class="container-item">
						<form class="form-search">
						<h1>Welcome</h1>
						<p class="span3">Enter your location:</p>
						 <div class="input-append span6">
						  <input class="input-xlarge span5" id="location" type="text" placeholder="Street, City, State">
							<button id="current-location" class="btn" type="button" data-trigger"hover" data-toggle="popover" data-content="Click for current Location" data-placement="top"
							data-loading-text="<i class='icon-refresh'></i>">
								<i class="icon-map-marker"></i>
							</button>
						</div>
						<button id="find" class="span1 btn">Find</button>
						</form>
					</div>
				</div>
			</div>
			
			<div id="map-row" class="row">
				<div id="map" style="display:none;">
					<div class="span2">
						<div class="container-item map-item">
						 
							<div id="q1" class="alert" style="display:none;">Draw the perimeter of your plant guild
							<i class="icon-arrow-right"></i>
							</div>
							
							<div id="composer-icons"  style="display:none;">
								<h4>Key Species</h4>
								<div class="btn-group btn-group-vertical" data-toggle="buttons-radio">
								  <button class="btn" data-category="primary"><img src="img/Tree-icon.png"><p name="Orange">Orange</p></button>
								  <button class="btn" data-category="primary"><img src="img/Tree-icon.png"><p name="Avacado">Avacado</p></button>
								  <button class="btn" data-category="primary"><img src="img/Tree-icon.png"><p name="Permisson">Persimmon</p></button>
								</div>
								<h4>Supporting Species</h4>
								<div class="btn-group btn-group-vertical" data-toggle="buttons-radio">
									<button class="btn" data-category="n-type"><img src="img/plant.png"><p name="Pea">Pea</p></button>
									<button class="btn" data-category="p-type"><img src="img/plant.png"><p name="Rosemary">Rosemary</p></button>
									<button class="btn" data-category="p-type"><img src="img/plant.png"><p name="Strawberry">Strawberry</p></button>
									<button class="btn" data-category="n-type"><img src="img/plant.png"><p name="Lavendar">Lavendar</p></button>
								</div>
							</div>
						</div>
					</div>
					<div class="span8" style="height:100%;">
						<div class="container-item">
							<div id="map-canvas" style="height:100%;"></div>
						</div>
					</div>
					<div class="span2">
						<div class="container-item">
						 
						<p id="temperature">Temperature
						<i class="icon-fire"></i>
						<h2>62Â°</h2>
						<p id="rainfall">Rain fall
						<i class="icon-tint"></i>
						<h2>6 in.</h2>
						<p id="rainfall">Other
						<i class="icon-leaf"></i>
						<i class="icon-globe"></i>
						</p>
						
						
						
						
						</div>
					</div>
				</div>
			</div>
			
			<div id="dashboard" class="row"  style="display:none;">
				<div class="span12 container-item">
				
					<div class="span4">
						<div id="inspector">
							<label></label>
							<img src=""/>
						</div>
					</div>
					<div class="span4">
						<div>
								<label class="control-label">Nitrogen</label>
								<div class="progress progress-info">
								  <div id="nitrogen" class="bar" style="width:0%"></div>
								</div>
								<label class="control-label">Pests</label>
								<div class="progress progress-success">
								  <div id="pests" class="bar" style="width:0%"></div>
								</div>
								
						</div>
					</div>
					<div class="span4">
					
					</div>				
				</div>
			</div>
			
			<div id="options-row" class="row">
				<div id="options" style="display:none;">
					<div class="span4">
						<div id="card1" class="container-item">
							<form>
							<p>Is there a building to the south of the guild?</p>
							<div class="btn-group" data-toggle="buttons-radio">
							  <input type="button" class="btn btn-good" value="Yes" />
							  <input type="button" class="btn btn-bad" value="No" />
							</div>
							</form>
						</div>
					</div>
					<div class="span4">
						<div id="card2" class="container-item">
						<div class="container-item">
							<ul id="sortable-species">
								<li class="item">Avacodo</li>
								<li class="item">Navel Orange</li>
								<li class="item">Persimmon</li>
							</ul>
						</div>
						</div>
					</div>
					<div class="span4">
						<div id="card2" class="container-item">
							<div class="container-item">
								<ul id="sortable">
									<li class="item">Mexican Sunflower - Dynamic Accumulator</li>
									<li class="item">Lavendar - Pollenating</li>
									<li class="item">Strawberry</li>
									<li class="item">Rosemary - Pest</li>
									<li class="item">Pidgeon Pea - NF</li>
									<li class="item">Marigold - Pest</li>
									<li class="item">Chard</li>
									<li class="item">Onion - Pest</li>
									<li class="item">Garlic - Pest</li>
									<li class="item">Leek - Pest</li>
									<li class="item">Raddish - Pest</li>
									<li class="item">Yarrow - Dynamic Accumulator</li>
									
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<div id="more-row"class="row">
				<div id="more"  style="display:none;">
					<div id="card3" class="span4">
						
					</div>
					<div class="span4">
						<div class="container-item">
						Lorem IpsumLorem IpsumLorem IpsumLorem IpsumLorem Ipsum
						</div>
					
					</div>
					<div class="span4">
						<div class="container-item">
						Lorem IpsumLorem IpsumLorem IpsumLorem IpsumLorem Ipsum
						</div>
					</div>
				</div>
			</div>
				
	
			<hr>
	
			<footer>
				<p>&copy; Project by Juliet Norton 2013</p>
			</footer>
	
		</div> <!-- /container -->
	
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
		<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
		<script src="js/vendor/bootstrap.min.js"></script>
		<script src="js/plugins.js"></script>
		<script src="js/lib/underscore-min.js"></script>
		<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.9.3/TweenMax.min.js"></script>
		<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=weather,drawing"></script>
		<!--<script src="js/main.js"></script>-->
		
		
		
		
		
		
		
		
		
		
		
		
		<script>
		$(document).ready(function(){
			$( "#sortable" ).sortable();
			$( "#sortable" ).disableSelection();
			$( "#map" ).hide();
			$( "#options" ).hide();
			$( "#more" ).hide();
		   	$( "#q1" ).hide();
			$( "#q2" ).hide();
			$( "#menu-map").hide();
			$( "#menu-options").hide();
			$( "#menu-more").hide(); 
			$( "#composer-icons").hide();
			$( "#dashboard" ).hide();
			$( "#map-row div.img").draggable({ opacity: 0.7, helper: "original" });
		   
			$("#current-location").popover({trigger: 'hover', delay: { show: 900, hide: 10 }});
				  $("#current-location").click(function (){
					  $("#current-location").button("loading");
					  $("#menu-map").slideDown();
					  google.maps.event.addDomListener(window, 'load', getCurrentLocation(function(pos){
						  console.log("resetting button");
						  $("#current-location").button("reset");
						  $("input[name='start-location']").val("Current Location");
						  $("input[name='start-location']").addClass("input-primary");
						  $("#current-location-group").addClass("info");
						  $("#current-location").addClass("btn-primary");
						  $("#current-location i").addClass("icon-white");
						  
						  console.log("before scroll");
						  console.log(pos);
						  getAddress(pos, function(data){
						  	console.log(data);
						  	$("#location").val(data);
						  });
						  console.log("scroll");
						  refreshSpy();
					  }));
			});
		  
		
		  	$('#find').on('click', function(event) {
				  event.preventDefault();
				  console.log("loading");
				  
				  $("#menu-map").slideDown();
				var address = $('#location').val();
					getGPS(address, function(data){
						slideMapDown(data);
					});
				refreshSpy();
				});
				
		  	clicks = 0;
		  	$('#next').on('click', function(event) {
				  event.preventDefault();
				  if(clicks == 0)
				  {
						  
						  console.log("click next 1");
						  $("#q2").slideDown();
						  $("#q1 i").removeClass();
						  $("#q1").addClass('muted');
						  $("#q2 i").addClass('icon-arrow-right');
						  refreshSpy()
				  }
				  else if(clicks == 1)
				  {
						  console.log("click next 2");
						  $('#options').slideDown();
						  $('#menu-options').slideDown();
						  scroll("#options");
						  $("#q2").addClass('muted');
						  $("#q2 i").removeClass();	
						  refreshSpy()
				  }
				  clicks++;
		  	});
		  
		  	$('#composer-icons button').click(function(){
			  console.log('icon click');
			  setDrawing($(this).find("img").attr('src'), $(this).attr("data-category"), $(this).find("p").attr('name'));
			  $('#inspector label').html($(this).html());
		  	}); 
		});
	 	var gmap;
	 	var geocoder;
	 	var markersArray = new Array();
	 	
		function initialize() 
		{
			geocoder = new google.maps.Geocoder();
			var pos = new google.maps.LatLng(60, 50);
			mapDiv = document.getElementById('map-canvas');
			
			var mapOptions = {
			    zoom: 20,
			    center: pos,
			    panControl: true,
			    zoomControl: true,
			    scaleControl: true,
			    mapTypeControl: true,
			    streetViewControl: true,
			    overviewMapControl: false,
			    mapTypeId: google.maps.MapTypeId.SATELLITE
			  }
			  
			gmap = new google.maps.Map(mapDiv, mapOptions);
			
			drawingManager = new google.maps.drawing.DrawingManager();
			drawingManager.setMap(gmap);			
			
			addPolygonDrawing();
			 /*
			google.maps.event.addListener(drawingManager, 'polygoncomplete', function(polygon) {
					  
			});*/
			
			google.maps.event.addListener(drawingManager, 'overlaycomplete', function(event) {
			  if (event.type == google.maps.drawing.OverlayType.MARKER) {
			    //event.overlay.setTitle("Hello");
			    console.log(event);
			    addMarker(event.overlay);
			    var infowindow = new google.maps.InfoWindow({
			      content: '<div id="content" onmouseover="updateContent()"><h1>'+ event.overlay.title+'</h1><label class="control-label">Nitrogen</label><div class="progress progress-info"><div id="nitrogen" class="bar" style="width:0%"></div></div><label class="control-label">Pests</label><div class="progress progress-success"><div id="pests" class="bar" style="width:0%"></div></div></div>',
			      maxWidth: 10
			    });
			    google.maps.event.addListener(event.overlay,'click',function(){
			      infowindow.open(gmap,event.overlay);
			    });
			  }
			  else if (event.type == google.maps.drawing.OverlayType.POLYGON) {
				  	console.log(event);
				   	$('#q1').slideUp(function(){
				   		$('#composer-icons').slideDown(function(){
				   			$('#dashboard').slideDown();
				   		});
				   		removePolygonDrawing();
				   });
			  }
			});
				
			var weatherLayer = new google.maps.weather.WeatherLayer({
			 		temperatureUnits: google.maps.weather.TemperatureUnit.FAHRENHEIT
					});
			weatherLayer.setMap(gmap);
				
			var cloudLayer = new google.maps.weather.CloudLayer();
			cloudLayer.setMap(gmap);
				
			var bikeLayer = new google.maps.BicyclingLayer();
			bikeLayer.setMap(map);	
		} 
		
		google.maps.event.addDomListener(window, 'load', initialize);
		
		function slideMapDown(pos)
		{
			var mapRow = $("#map");
			mapRow.show("normal", function()
			{
				scroll("#map");
				TweenMax.to(mapRow, 1, {
				 height:"400px", ease:Quad.easeOut, onComplete: function()
				 {
					 google.maps.event.trigger(gmap, 'resize');
					 gmap.setZoom( gmap.getZoom() );
					 gmap.setCenter(pos);
					 var marker = new google.maps.Marker({
						 map: gmap,
						 position: pos,
						 animation: google.maps.Animation.DROP
					 });
					 google.maps.event.addListener(gmap, 'idle', function() {
					  	$("#q1").slideDown("normal", function(){
					  		$(this).addClass("alert-success");
					  	});
					 });
				 }});
			});        
		}
			
		function getGPS(address, output)
		{
		    geocoder.geocode( { 'address': address}, function(results, status) 
		        {
		          if (status == google.maps.GeocoderStatus.OK) 
		          {
		          	
		          	output(results[0].geometry.location);
		          }
		          else 
		          {
		              console.log(status);
		          }
		        }
		    );
		}
			
		function getAddress(location, output)
		{
		    geocoder.geocode( { 'latLng': location }, function(results, status)
		        {
		        	console.log(status);
		          if (status == google.maps.GeocoderStatus.OK)
		          {
			          	output(results[0].formatted_address);
		          }
		          else
		          {
		          		console.log(status);
		          }
		        }
		    );
		}
			
		function getCurrentLocation(callback)
		{
			navigator.geolocation.getCurrentPosition(function(position){
				var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
				slideMapDown(pos);    
				callback(pos);
				console.log(pos);
			}, displayError);
		}
			
		function displayError(error) 
		{
		  var errors = { 
			1: 'Permission denied',
			2: 'Position unavailable',
			3: 'Request timeout'
		  };
		  alert("Error: " + errors[error.code]);
		} 		      
			  
		function setDrawing(icon, title, name) 
		{
			drawingManager.setOptions({
			   drawingMode: google.maps.drawing.OverlayType.MARKER,
			   drawingControl: true,
			   drawingControlOptions: {
				 position: google.maps.ControlPosition.TOP_CENTER,
				 drawingModes: [
				   google.maps.drawing.OverlayType.MARKER,
				   google.maps.drawing.OverlayType.POLYGON,
				 ]
			   },
			   markerOptions: {
				 icon: icon,
				 draggable: true,
				 title: title
			   }
		 	});
	   	}
			   
	   	function removePolygonDrawing()
	   	{
		   drawingManager.setOptions({
			 drawingMode: google.maps.drawing.OverlayType.MARKER,
			 drawingControl: true,
			 drawingControlOptions: {
			   position: google.maps.ControlPosition.TOP_CENTER,
			   drawingModes: [google.maps.drawing.OverlayType.MARKER]
			 }
		   });
	   	}
	   
	   	function addPolygonDrawing()
	   	{
		   drawingManager.setOptions({
			 drawingMode: google.maps.drawing.OverlayType.POLYGON,
			 drawingControl: true,
			 drawingControlOptions: {
			   position: google.maps.ControlPosition.TOP_CENTER,
			   drawingModes: [google.maps.drawing.OverlayType.POLYGON]
			 }
		   });
	   	}
	   	
	   	// Removes the overlays from the map, but keeps them in the array
	   	function addMarker(marker) {
	   	  markersArray.push(marker);
	   	  updateProgressBars();
	   	}
							  
		// Removes the overlays from the map, but keeps them in the array
		function clearOverlays() {
		  if (markersArray) {
			for (i in markersArray) {
			  markersArray[i].setMap(null);
			}
		  }
		}
				
		// Shows any overlays currently in the array
		function showOverlays() {
		  if (markersArray) {
			for (i in markersArray) {
			  markersArray[i].setMap(gmap);
			}
		  }
		}
				
		// Deletes all markers in the array by removing references to them
		function deleteOverlays() {
		  if (markersArray) {
			for (i in markersArray) {
			  markersArray[i].setMap(null);
			}
			markersArray.length = 0;
		  }
		}
		
		
		function scroll(id)
		{
			$("html, body").animate({ scrollTop: $(id).offset().top - 75}, 1000);
		}
			
		function refreshSpy()
		{
			$('[data-spy="scroll"]').each(function () {
			  $(this).scrollspy('refresh');
			});
		
		}
		
	 	function updateProgressBars()
	 	{
	 		$(".bar").each(function(){
	 			width = [(markersArray.length)/4]*100;
	 			$(this).css("width", width + "%");
	 		});	 	
	 	
	 	
	 	
	 	}
	</script>
	   
		
		
		
		
		
		
		
		
		
		
		
	</body>
	</html>
